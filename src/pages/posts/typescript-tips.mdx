---
layout: ../../layouts/PostLayout.astro
title: TypeScript 小技巧
date: 2023-08-05
category: 编程语言
description: 整理一些常用但容易忽视的 TypeScript 技巧，帮助你写出更好的 TypeScript 代码。
tags:
  - TypeScript
  - Tips
  - 编程技巧
---

# TypeScript 小技巧

TypeScript 作为 JavaScript 的超集，提供了强大的类型系统。这里整理一些常用但容易忽视的 TypeScript 技巧。

## 1. satisfies 操作符

TypeScript 4.9 引入的 `satisfies` 操作符，可以在保持推断类型的同时验证类型约束：

```ts
const config = {
  development: {
    apiUrl: 'http://localhost:3000',
    timeout: 5000
  },
  production: {
    apiUrl: 'https://api.example.com',
    timeout: 10000
  }
} satisfies Record<string, { apiUrl: string; timeout: number }>;

// config.development.apiUrl 的类型是 string
// 而不是 string | number
```

## 2. const 断言

使用 `as const` 可以让 TypeScript 推断出更精确的字面量类型：

```ts
const colors = ['red', 'green', 'blue'] as const;
// 类型：readonly ["red", "green", "blue"]

const point = { x: 10, y: 20 } as const;
// 类型：{ readonly x: 10; readonly y: 20; }
```

## 3. 条件类型

条件类型允许根据条件选择不同的类型：

```ts
type NonNullable<T> = T extends null | undefined ? never : T;

type Example1 = NonNullable<string | null>; // string
type Example2 = NonNullable<string | undefined>; // string
```

## 4. 映射类型

映射类型可以基于现有类型创建新类型：

```ts
type Partial<T> = {
  [P in keyof T]?: T[P];
};

type Required<T> = {
  [P in keyof T]-?: T[P];
};
```

## 5. 模板字面量类型

TypeScript 4.1 引入了模板字面量类型：

```ts
type EventName<T extends string> = `on${Capitalize<T>}`;

type MouseEvent = EventName<'click'>; // "onClick"
type KeyEvent = EventName<'keyDown'>; // "onKeyDown"
```

## 6. infer 关键字

`infer` 可以在条件类型中推断类型：

```ts
type ReturnType<T> = T extends (...args: any[]) => infer R ? R : never;

type Func = () => string;
type Result = ReturnType<Func>; // string
```

## 7. 工具类型

TypeScript 提供了许多内置的工具类型：

```ts
interface User {
  id: number;
  name: string;
  email: string;
  age: number;
}

type UserPartial = Partial<User>; // 所有属性可选
type UserPick = Pick<User, 'id' | 'name'>; // 选择特定属性
type UserOmit = Omit<User, 'age'>; // 排除特定属性
```

## 8. 类型守卫

自定义类型守卫可以帮助 TypeScript 更好地理解你的代码：

```ts
function isString(value: unknown): value is string {
  return typeof value === 'string';
}

function processValue(value: unknown) {
  if (isString(value)) {
    // TypeScript 知道这里 value 是 string 类型
    console.log(value.toUpperCase());
  }
}
```

## 总结

这些 TypeScript 技巧可以帮助你写出更类型安全、更易维护的代码。随着对 TypeScript 的深入使用，你会发现更多有用的模式和技巧。

持续学习，让 TypeScript 成为你开发路上的得力助手！ 